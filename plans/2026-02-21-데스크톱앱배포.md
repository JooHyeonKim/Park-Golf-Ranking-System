# 데스크톱 앱 배포 (Electron)

## 개요
파크골프 PWA를 Electron으로 감싸 macOS/Windows 데스크톱 앱으로 패키징.
GitHub Releases를 통해 .dmg(맥), .exe(윈도우) 설치 파일 배포.

## 요구사항
- 불특정 다수의 사용자가 웹에서 다운로드하여 로컬에서 사용
- macOS (.dmg) + Windows (.exe NSIS 인스톨러) 지원
- 기존 `src/` 소스코드를 복제하지 않고 공유
- GitHub Actions로 자동 빌드 및 릴리스

## 핵심 설계 결정
- `desktop_version/` 폴더에 별도 프로젝트 구성
- Vite `resolve.alias`로 루트 `src/`를 `@src`로 참조 (소스 복제 없음)
- Electron 메인 프로세스: CommonJS (`contextIsolation: true`, `nodeIntegration: false`)
- `renderer/main.jsx`에서 서비스워커 등록 제거 (PWA 코드 분리)
- `electron-updater`로 자동 업데이트 지원

## 생성 파일

| 파일 | 설명 |
|------|------|
| `desktop_version/package.json` | Electron 40 + electron-builder 26 설정 |
| `desktop_version/vite.config.mjs` | VitePWA 제거, `@src` 별칭, `base: './'` |
| `desktop_version/tailwind.config.cjs` | content에 `../src/**/*` 포함 |
| `desktop_version/postcss.config.cjs` | 루트와 동일 |
| `desktop_version/index.html` | PWA 메타태그 제거, CSP 헤더 추가 |
| `desktop_version/electron/main.js` | 메인 프로세스 (1200x800 창, 메뉴, 자동 업데이트) |
| `desktop_version/electron/preload.js` | 최소 contextBridge |
| `desktop_version/renderer/main.jsx` | 진입점 (서비스워커 없음, `@src/App` 임포트) |
| `desktop_version/renderer/index.css` | `@import '../../src/index.css'` |
| `desktop_version/resources/icon.icns` | macOS 아이콘 |
| `desktop_version/resources/icon.ico` | Windows 아이콘 |
| `desktop_version/resources/icon.png` | 512x512 원본 |
| `.github/workflows/desktop-release.yml` | `desktop-v*` 태그 시 Mac/Win 빌드 자동화 |

기존 `src/` 파일은 **수정하지 않음**.

## 프로젝트 구조
```
desktop_version/
├── package.json
├── vite.config.mjs
├── tailwind.config.cjs
├── postcss.config.cjs
├── index.html
├── .gitignore
├── electron/
│   ├── main.js
│   └── preload.js
├── renderer/
│   ├── main.jsx
│   └── index.css
├── public/
│   └── favicon.svg
└── resources/
    ├── icon.icns
    ├── icon.ico
    └── icon.png
```

## 사용 명령어
```bash
cd desktop_version
npm install           # 의존성 설치
npm run dev:electron  # 개발 모드 (Vite + Electron)
npm run package:mac   # macOS DMG 빌드
npm run package:win   # Windows EXE 빌드
```

## 배포 방법
```bash
git tag desktop-v1.0.0
git push origin desktop-v1.0.0
# → GitHub Actions가 자동으로 빌드 후 Releases에 .dmg/.exe 업로드
```

## 참고사항
- VS Code 터미널에서 Electron 실행 시 `ELECTRON_RUN_AS_NODE=` 환경변수 해제 필요 (dev:electron 스크립트에 포함됨)
- 코드 서명 미설정 → 사용자에게 "확인되지 않은 개발자" 경고 표시됨
- macOS DMG는 universal 빌드 (x64 + arm64)

## 구현 완료
- [x] desktop_version 프로젝트 구성
- [x] Electron 메인/프리로드 프로세스
- [x] Vite + Tailwind 빌드 설정
- [x] 앱 아이콘 생성 (icns, ico, png)
- [x] GitHub Actions 워크플로우
- [x] macOS DMG 패키징 테스트 통과
